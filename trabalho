#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define TAMANHO_NOME

typedef struct Sala {
    char nome[TAMANHO_NOME];
    struct Sala *esquerda;
    struct Sala *direita;
} Sala;

Sala* criarSala(const char *nome_sala) {

    Sala *nova_sala = (Sala*)malloc(sizeof(Sala));
  
    if (nova_sala == NULL) {
        perror("Erro na aloca√ß√£o de mem√≥ria para nova sala");
        exit(EXIT_FAILURE);
    }

    strncpy(nova_sala->nome, nome_sala, TAMANHO_NOME - 1);
    nova_sala->nome[TAMANHO_NOME - 1] = '\0';
    nova_sala->esquerda = NULL;
    nova_sala->direita = NULL;
    
    return nova_sala;
}

/
void explorarSalas(Sala *atual) {
    char escolha;

    while (atual != NULL) {
        printf("\nVoc√™ est√° em: **%s**\n", atual->nome);

        if (atual->esquerda == NULL && atual->direita == NULL) {
            printf("\nüéâ Fim da explora√ß√£o! Este c√¥modo n√£o tem mais sa√≠das. üéâ\n");
            return;
        }

        printf("Para onde deseja ir?\n");
        
        if (atual->esquerda != NULL) {
            printf("  [e] -> Esquerda (%s)\n", atual->esquerda->nome);
        }
        if (atual->direita != NULL) {
            printf("  [d] -> Direita (%s)\n", atual->direita->nome);
        }
        printf("  [s] -> Sair da mans√£o\n");
        printf("Escolha (e/d/s): ");

        if (scanf(" %c", &escolha) != 1) {
       
            while(getchar() != '\n'); 
            escolha = ' '; 
        }
        
        if (escolha == 'e' || escolha == 'E') {
            if (atual->esquerda != NULL) {
                atual = atual->esquerda; 
            } else {
                printf("Caminho 'esquerda' n√£o existe. Tente outra op√ß√£o.\n");
            }
        } else if (escolha == 'd' || escolha == 'D') {
            if (atual->direita != NULL) {
                atual = atual->direita;
            } else {
                printf("Caminho 'direita' n√£o existe. Tente outra op√ß√£o.\n");
            }
        } else if (escolha == 's' || escolha == 'S') {
            printf("\nüö™ Voc√™ decidiu sair da mans√£o. At√© logo!\n");
            return;
        } else {
            printf("Op√ß√£o inv√°lida. Digite 'e', 'd' ou 's'.\n");
        }
    }
}

void liberarMemoria(Sala *raiz) {
    if (raiz == NULL) {
        return;
    }
    
    liberarMemoria(raiz->esquerda);
    liberarMemoria(raiz->direita);
    free(raiz);
}


int main() {
    printf("======================================\n");
    printf("üö™ Bem-vindo √† Mans√£o do C√≥digo Secreto! üóùÔ∏è\n");
    printf("======================================\n");
    printf("Regra: Escolha 'e' (esquerda) ou 'd' (direita) para avan√ßar.\n");

    Sala *hall = criarSala("Hall de Entrada");

    Sala *sala_estar = criarSala("Sala de Estar");
    Sala *cozinha = criarSala("Cozinha");
    hall->esquerda = sala_estar;
    hall->direita = cozinha;

    Sala *biblioteca = criarSala("Biblioteca");
    Sala *jardim = criarSala("Jardim");
    sala_estar->esquerda = biblioteca;
    sala_estar->direita = jardim;

    Sala *dispensa = criarSala("Dispensa");
    Sala *escritorio = criarSala("Escrit√≥rio");
    cozinha->esquerda = dispensa;
    cozinha->direita = escritorio;

    Sala *quarto_principal = criarSala("Quarto Principal");
    biblioteca->esquerda = quarto_principal;
 
    Sala *porao = criarSala("Por√£o");
    escritorio->direita = porao;

    explorarSalas(hall);

    liberarMemoria(hall);
    printf("\n\nMem√≥ria alocada liberada com sucesso.\n");

    return 0;
}


#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define TAMANHO_NOME 50
#define TAMANHO_PISTA 100


typedef struct PistaNode {
    char pista[TAMANHO_PISTA];
    struct PistaNode *esquerda;
    struct PistaNode *direita;
} PistaNode;

typedef struct Sala {
    char nome[TAMANHO_NOME];
    char pista[TAMANHO_PISTA];
    struct Sala *esquerda;
    struct Sala *direita;
} Sala;

void liberarMansao(Sala *raiz) {
    if (raiz == NULL) return;
    liberarMansao(raiz->esquerda);
    liberarMansao(raiz->direita);
    free(raiz);
}

void liberarPistas(PistaNode *raiz) {
    if (raiz == NULL) return;
    liberarPistas(raiz->esquerda);
    liberarPistas(raiz->direita);
    free(raiz);
}

/
Sala* criarSala(const char *nome_sala, const char *conteudo_pista) {
    Sala *nova_sala = (Sala*)malloc(sizeof(Sala));
    
    if (nova_sala == NULL) {
        perror("Erro na aloca√ß√£o de mem√≥ria para Sala");
        exit(EXIT_FAILURE);
    }

    strncpy(nova_sala->nome, nome_sala, TAMANHO_NOME - 1);
    nova_sala->nome[TAMANHO_NOME - 1] = '\0';
    
    strncpy(nova_sala->pista, conteudo_pista, TAMANHO_PISTA - 1);
    nova_sala->pista[TAMANHO_PISTA - 1] = '\0';

    nova_sala->esquerda = NULL;
    nova_sala->direita = NULL;
    
    return nova_sala;
}

PistaNode* criarPistaNode(const char *conteudo) {
    PistaNode *novo_node = (PistaNode*)malloc(sizeof(PistaNode));
    if (novo_node == NULL) {
        perror("Erro na aloca√ß√£o de mem√≥ria para PistaNode");
        exit(EXIT_FAILURE);
    }
    strncpy(novo_node->pista, conteudo, TAMANHO_PISTA - 1);
    novo_node->pista[TAMANHO_PISTA - 1] = '\0';
    novo_node->esquerda = NULL;
    novo_node->direita = NULL;
    return novo_node;
}

PistaNode* inserirPista(PistaNode *raiz, const char *conteudo) {

    if (raiz == NULL) {
        return criarPistaNode(conteudo);
    }

    int comparacao = strcmp(conteudo, raiz->pista);
    
    if (comparacao < 0) {
        raiz->esquerda = inserirPista(raiz->esquerda, conteudo);
    } else if (comparacao > 0) {
        raiz->direita = inserirPista(raiz->direita, conteudo);
    } 

    return raiz;
}

void exibirPistas(PistaNode *raiz, int *contador) {
    if (raiz != NULL) {
        exibirPistas(raiz->esquerda, contador);

        printf("  %02d. %s\n", ++(*contador), raiz->pista);

        exibirPistas(raiz->direita, contador);
    }
}


PistaNode* explorarSalasComPistas(Sala *raiz_mansao, PistaNode *raiz_pistas) {
    Sala *atual = raiz_mansao;
    char escolha;
    
    printf("\n--- In√≠cio da Explora√ß√£o ---\n");

    while (atual != NULL) {
        printf("\nVoc√™ est√° em: üìç **%s**\n", atual->nome);

        if (strlen(atual->pista) > 0) {
            printf("  ‚ú® PISTA ENCONTRADA: \"%s\"\n", atual->pista);

            raiz_pistas = inserirPista(raiz_pistas, atual->pista);

            atual->pista[0] = '\0'; 
        }

        printf("\nPara onde deseja ir?\n");
        int tem_caminho = 0;

        if (atual->esquerda != NULL) {
            printf("  [e] -> Esquerda (%s)\n", atual->esquerda->nome);
            tem_caminho = 1;
        }
        if (atual->direita != NULL) {
            printf("  [d] -> Direita (%s)\n", atual->direita->nome);
            tem_caminho = 1;
        }
        printf("  [s] -> Sair da mans√£o e ver as pistas\n");
        
        if (!tem_caminho) {
            printf("\n‚ö†Ô∏è Este c√¥modo n√£o tem mais sa√≠das. Escolha [s] para sair e ver suas pistas.\n");
        }
        
        printf("Escolha (e/d/s): ");

        if (scanf(" %c", &escolha) != 1) {
            while(getchar() != '\n'); 
            escolha = ' '; 
        }

        if (escolha == 's' || escolha == 'S') {
            printf("\nüö™ Voc√™ decidiu sair da mans√£o.\n");
            return raiz_pistas;
        } else if (escolha == 'e' || escolha == 'E') {
            if (atual->esquerda != NULL) {
                atual = atual->esquerda;
            } else {
                printf("Caminho 'esquerda' n√£o existe.\n");
            }
        } else if (escolha == 'd' || escolha == 'D') {
            if (atual->direita != NULL) {
                atual = atual->direita;
            } else {
                printf("Caminho 'direita' n√£o existe.\n");
            }
        } else {
            printf("Op√ß√£o inv√°lida.\n");
        }
    }
    
    return raiz_pistas; 
}


int main() {
    printf("===================================================\n");
    printf("üîé Mans√£o de Pistas: Uma Aventura com √Årvores BST üîç\n");
    printf("===================================================\n");

    Sala *hall = criarSala("Hall de Entrada", "O culpado tem uma predilecao por azul.");

    Sala *sala_estar = criarSala("Sala de Estar", "A hora do crime foi proxima a meia-noite.");
    Sala *cozinha = criarSala("Cozinha", "Nenhuma pista aqui.");
    hall->esquerda = sala_estar;
    hall->direita = cozinha;

    Sala *biblioteca = criarSala("Biblioteca", "O objeto roubado esta escondido no sul.");
    Sala *jardim = criarSala("Jardim", "Nenhuma pista aqui.");
    sala_estar->esquerda = biblioteca;
    sala_estar->direita = jardim;

    Sala *dispensa = criarSala("Dispensa", "O mordomo estava na cidade vizinha.");
    Sala *escritorio = criarSala("Escritorio", "Nenhuma pista aqui.");
    cozinha->esquerda = dispensa;
    cozinha->direita = escritorio;

    Sala *quarto_principal = criarSala("Quarto Principal", "A chave tem 5 digitos.");
    biblioteca->esquerda = quarto_principal;

    Sala *porao = criarSala("Porao", "O nome da v√≠tima come√ßa com a letra J.");
    escritorio->direita = porao;
    
    PistaNode *pistas_coletadas = NULL;

    pistas_coletadas = explorarSalasComPistas(hall, pistas_coletadas);
    
    printf("\n===================================================\n");
    printf("üìÑ Relat√≥rio Final: Pistas Coletadas (Ordem Alfab√©tica)\n");
    printf("===================================================\n");

    int contador = 0;
    if (pistas_coletadas == NULL) {
        printf("Nenhuma pista foi coletada durante a explora√ß√£o.\n");
    } else {

        exibirPistas(pistas_coletadas, &contador);
    }
    
    liberarMansao(hall);
    liberarPistas(pistas_coletadas);
    printf("\n\nMem√≥ria alocada liberada com sucesso.\n");

    return 0;
}

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stdbool.h>

#define TAMANHO_NOME
#define TAMANHO_PISTA
#define TAMANHO_SUSPEITO
#define TAMANHO_TABELA_HASH

typedef struct Sala {
    char nome[TAMANHO_NOME];
    struct Sala *esquerda;
    struct Sala *direita;
} Sala;

typedef struct PistaNode {
    char pista[TAMANHO_PISTA];
    struct PistaNode *esquerda;
    struct PistaNode *direita;
} PistaNode;

typedef struct HashNode {
    char pista[TAMANHO_PISTA];
    char suspeito[TAMANHO_SUSPEITO];
    struct HashNode *proximo;
} HashNode;

HashNode *tabelaHash[TAMANHO_TABELA_HASH];

PistaNode *pistas_coletadas = NULL; 
char pistas_coletadas_array[10][TAMANHO_PISTA];
int total_pistas_coletadas = 0;

void liberarMansao(Sala *raiz) {
    if (raiz == NULL) return;
    liberarMansao(raiz->esquerda);
    liberarMansao(raiz->direita);
    free(raiz);
}

int funcaoHash(const char *chave) {
    unsigned long hash = 0;
    int c;
    while ((c = *chave++)) {
        hash = hash + c;
    }
    return hash % TAMANHO_TABELA_HASH;
}

void inserirNaHash(const char *pista, const char *suspeito) {
    int indice = funcaoHash(pista);

    HashNode *novo_node = (HashNode*)malloc(sizeof(HashNode));
    if (novo_node == NULL) {
        perror("Erro na aloca√ß√£o de mem√≥ria para HashNode");
        exit(EXIT_FAILURE);
    }
    strncpy(novo_node->pista, pista, TAMANHO_PISTA - 1);
    strncpy(novo_node->suspeito, suspeito, TAMANHO_SUSPEITO - 1);
    novo_node->proximo = NULL;

    novo_node->proximo = tabelaHash[indice];
    tabelaHash[indice] = novo_node;
}

const char* encontrarSuspeito(const char *pista) {
    int indice = funcaoHash(pista);
    HashNode *atual = tabelaHash[indice];

    while (atual != NULL) {
        if (strcmp(atual->pista, pista) == 0) {
            return atual->suspeito;
        }
        atual = atual->proximo;
    }
    return NULL;
}

void liberarHash() {
    for (int i = 0; i < TAMANHO_TABELA_HASH; i++) {
        HashNode *atual = tabelaHash[i];
        while (atual != NULL) {
            HashNode *temp = atual;
            atual = atual->proximo;
            free(temp);
        }
        tabelaHash[i] = NULL;
    }
}

PistaNode* criarPistaNode(const char *conteudo) {
    PistaNode *novo_node = (PistaNode*)malloc(sizeof(PistaNode));
    if (novo_node == NULL) {
        perror("Erro na aloca√ß√£o de mem√≥ria para PistaNode");
        exit(EXIT_FAILURE);
    }
    strncpy(novo_node->pista, conteudo, TAMANHO_PISTA - 1);
    novo_node->esquerda = NULL;
    novo_node->direita = NULL;
    return novo_node;
}
/
PistaNode* inserirPista(PistaNode *raiz, const char *conteudo) {
    if (raiz == NULL) {

        if (total_pistas_coletadas < 10) {
            strncpy(pistas_coletadas_array[total_pistas_coletadas++], conteudo, TAMANHO_PISTA - 1);
        }
        return criarPistaNode(conteudo);
    }

    int comparacao = strcmp(conteudo, raiz->pista);
    
    if (comparacao < 0) {
        raiz->esquerda = inserirPista(raiz->esquerda, conteudo);
    } else if (comparacao > 0) {
        raiz->direita = inserirPista(raiz->direita, conteudo);
    } 
    return raiz;
}

void listarPistas(PistaNode *raiz) {
    static int contador = 0;
    if (raiz != NULL) {
        listarPistas(raiz->esquerda);
        printf("  %02d. %s\n", ++contador, raiz->pista);
        listarPistas(raiz->direita);
    }
}

void liberarPistas(PistaNode *raiz) {
    if (raiz == NULL) return;
    liberarPistas(raiz->esquerda);
    liberarPistas(raiz->direita);
    free(raiz);
}


Sala* criarSala(const char *nome_sala) {
    Sala *nova_sala = (Sala*)malloc(sizeof(Sala));
    
    if (nova_sala == NULL) {
        perror("Erro na aloca√ß√£o de mem√≥ria para Sala");
        exit(EXIT_FAILURE);
    }
    
    strncpy(nova_sala->nome, nome_sala, TAMANHO_NOME - 1);
    nova_sala->esquerda = NULL;
    nova_sala->direita = NULL;
    
    return nova_sala;
}

/
const char* obterPistaPorSala(const char *nome_sala) {
    if (strcmp(nome_sala, "Hall de Entrada") == 0) return "O crime ocorreu na parte leste da mansao.";
    if (strcmp(nome_sala, "Sala de Estar") == 0) return "O suspeito tem olhos azuis.";
    if (strcmp(nome_sala, "Cozinha") == 0) return "Nenhuma pista relevante aqui.";
    if (strcmp(nome_sala, "Biblioteca") == 0) return "O Suspeito e alto.";
    if (strcmp(nome_sala, "Jardim") == 0) return "A arma do crime foi um candelabro.";
    if (strcmp(nome_sala, "Escritorio") == 0) return "O suspeito usava um anel de sinete.";
    if (strcmp(nome_sala, "Quarto Principal") == 0) return "A vitima conhecia o assassino.";
    return ""; // Sem pista
}


void explorarSalas(Sala *hall) {
    Sala *atual = hall;
    char escolha;
    
    printf("\n--- In√≠cio da Explora√ß√£o ---\n");

    while (atual != NULL) {
        printf("\nVoc√™ est√° em: üìç **%s**\n", atual->nome);

        const char *pista_encontrada = obterPistaPorSala(atual->nome);
        
        if (strlen(pista_encontrada) > 0 && encontrarSuspeito(pista_encontrada) != NULL) {
            printf("  ‚ú® PISTA COLETADA: \"%s\"\n", pista_encontrada);
       
            pistas_coletadas = inserirPista(pistas_coletadas, pista_encontrada);
        } else if (strlen(pista_encontrada) > 0) {
             printf("  ‚ÑπÔ∏è PISTA IRRELEVANTE: \"%s\"\n", pista_encontrada);
        } else {
             printf("  Nenhuma pista encontrada neste comodo.\n");
        }

        printf("\nPara onde deseja ir?\n");
        if (atual->esquerda != NULL) {
            printf("  [e] -> Esquerda\n");
        }
        if (atual->direita != NULL) {
            printf("  [d] -> Direita\n");
        }
        printf("  [s] -> Sair e ir para o julgamento\n");
        
        printf("Escolha (e/d/s): ");

        if (scanf(" %c", &escolha) != 1) {
            while(getchar() != '\n'); 
            escolha = ' '; 
        }

        if (escolha == 's' || escolha == 'S') {
            printf("\nüö™ Voc√™ decidiu encerrar a exploracao.\n");
            return;
        } else if (escolha == 'e' || escolha == 'E') {
            if (atual->esquerda != NULL) {
                atual = atual->esquerda;
            } else {
                printf("Caminho 'esquerda' nao existe.\n");
            }
        } else if (escolha == 'd' || escolha == 'D') {
            if (atual->direita != NULL) {
                atual = atual->direita;
            } else {
                printf("Caminho 'direita' nao existe.\n");
            }
        } else {
            printf("Opcao invalida.\n");
        }
    }
}

void verificarSuspeitoFinal() {
    printf("\n=============================================\n");
    printf("üèõÔ∏è FASE FINAL: JULGAMENTO üèõÔ∏è\n");
    printf("=============================================\n");

    printf("\nLista de Pistas Coletadas:\n");
    if (pistas_coletadas == NULL) {
        printf("Nenhuma pista relevante foi coletada.\n");
        return;
    }
    listarPistas(pistas_coletadas);

    char acusacao[TAMANHO_SUSPEITO];
    printf("\nBaseado nas pistas, quem voce acusa? (Digite o nome do suspeito): ");
    scanf(" %[^\n]", acusacao);
  
    int pistas_para_suspeito = 0;

    for (int i = 0; i < total_pistas_coletadas; i++) {
        const char *suspeito_associado = encontrarSuspeito(pistas_coletadas_array[i]);
        
        if (suspeito_associado != NULL && strcmp(suspeito_associado, acusacao) == 0) {
            pistas_para_suspeito++;
        }
    }

    printf("\n--- DESFECHO ---\n");
    printf("Suspeito acusado: %s\n", acusacao);
    printf("Pistas que apontam para %s: %d\n", acusacao, pistas_para_suspeito);

    if (pistas_para_suspeito >= 2) {
        printf("‚úÖ PARABENS! Voce tem %d pistas que apontam para %s.\n", pistas_para_suspeito, acusacao);
        printf("O caso foi solucionado com sucesso!\n");
    } else {
        printf("‚ùå A acusacao falhou. Voce precisa de, pelo menos, 2 pistas solidas.\n");
        printf("O culpado esta livre. Tente novamente...\n");
    }
}

int main() {
    memset(tabelaHash, 0, sizeof(tabelaHash));

    inserirNaHash("O crime ocorreu na parte leste da mansao.", "Mordomo");
    inserirNaHash("O suspeito tem olhos azuis.", "Mordomo");
    inserirNaHash("O suspeito usava um anel de sinete.", "Mordomo"); 
    
    inserirNaHash("A arma do crime foi um candelabro.", "Governanta");
    inserirNaHash("O Suspeito e alto.", "Governanta");
    
    inserirNaHash("A vitima conhecia o assassino.", "Jardineiro");

    Sala *hall = criarSala("Hall de Entrada");

    Sala *sala_estar = criarSala("Sala de Estar");
    Sala *cozinha = criarSala("Cozinha");
    hall->esquerda = sala_estar;
    hall->direita = cozinha;

    Sala *biblioteca = criarSala("Biblioteca");
    Sala *jardim = criarSala("Jardim"); 
    sala_estar->esquerda = biblioteca;
    sala_estar->direita = jardim;

    Sala *escritorio = criarSala("Escritorio");
    cozinha->direita = escritorio;

    Sala *quarto_principal = criarSala("Quarto Principal"); 
    biblioteca->esquerda = quarto_principal;
  
    explorarSalas(hall);
    verificarSuspeitoFinal();
  
    liberarMansao(hall);
    liberarPistas(pistas_coletadas);
    liberarHash();

    printf("\n\nPrograma encerrado e memoria liberada.\n");

    return 0;
}
